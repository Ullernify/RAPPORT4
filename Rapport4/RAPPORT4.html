<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ulrich">

<title>STUDIEDESIGN</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="RAPPORT4_files/libs/clipboard/clipboard.min.js"></script>
<script src="RAPPORT4_files/libs/quarto-html/quarto.js"></script>
<script src="RAPPORT4_files/libs/quarto-html/popper.min.js"></script>
<script src="RAPPORT4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="RAPPORT4_files/libs/quarto-html/anchor.min.js"></script>
<link href="RAPPORT4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="RAPPORT4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="RAPPORT4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="RAPPORT4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="RAPPORT4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">STUDIEDESIGN</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ulrich </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="studiedesign-og-statistisk-analyse" class="level1">
<h1>Studiedesign og statistisk analyse</h1>
<p>Hensikten med denne rapporten er å sammenligne fem studier sine studiedesign og metoder for statistisk analyse.</p>
<section id="introduksjon" class="level2">
<h2 class="anchored" data-anchor-id="introduksjon">Introduksjon</h2>
<p>I dagens idrettsvitenskapelige forskningsfelt spiller studiedesign og statistiske modeller en sentral rolle for innhenting og analyse av data. Statistisk analyse blir ofte brukt som et forsøk på å trekke meningsfulle konkulsjoner fra en mengde innsamlede data. Dette være seg til hypotesetesting, forutsi fremtidige utfall eller avdekke årsakssammenhenger. Statistiske modeller kan være svært komplekse, noe som kan gjøre det vanskelig for forskere å vurdere hvilke analyser som egner seg best til sine innsamlede data <span class="citation" data-cites="Atkinson">(<a href="#ref-Atkinson" role="doc-biblioref">Atkinson and Nevill 2001</a>)</span>. Hvilke statistiske modeller som skal bli brukt på innsamled data burde derfor ses i sammenheng med studiedesign <span class="citation" data-cites="Hulley">(<a href="#ref-Hulley" role="doc-biblioref">Hulley et al. 2006</a>)</span></p>
<p>Et studiedesign er strukturen til en studie, en beskrivelse av studiens gjennomføring og alle aspekter av datainnsamlingen <span class="citation" data-cites="Knight">(<a href="#ref-Knight" role="doc-biblioref">Knight 2010</a>)</span>. Studier har derfor forskjellig struktur for å best fange opp den aktuelle forskningens formål <span class="citation" data-cites="Creswell">(<a href="#ref-Creswell" role="doc-biblioref">Creswell 2008</a>)</span>. I studier hvor formålet er å undersøke fysiologiske responser på trening brukes ofte et randomisert-kontrollert studiedesign (RCT) da dette blir sett på som gullstandarden innen idrettsvitenskap <span class="citation" data-cites="Bouchard">(<a href="#ref-Bouchard" role="doc-biblioref">Bouchard, Blair, and Haskell 2012</a>)</span>. Dette vil si at forsøkspersonene fordeles tilfeldig i en eksperimentell gruppe som får en behandling, her som blokkperiodisering av trening (BP) og en kontroll-gruppe som ikke får behandling, eventuelt en behandling til sammenligning, her som tradisjonell trening (TRAD) <span class="citation" data-cites="Hulley">(<a href="#ref-Hulley" role="doc-biblioref">Hulley et al. 2006</a>)</span>.</p>
</section>
<section id="metode" class="level2">
<h2 class="anchored" data-anchor-id="metode">Metode</h2>
<p>Analysene bygger på QUALMRI-metoden <span class="citation" data-cites="Brosowsky">(<a href="#ref-Brosowsky" role="doc-biblioref">Brosowsky et al. 2020</a>)</span> og tar for seg fem studier som undersøker effekten av blokkperiodisering på utholdenhetstrening med et kriterium om at den fysiologiske variabelen VO2max er blitt målt. Analysen har fokusert på likheter, ulikheter, styrker og svakheter ved studienes design og bruk av statistiske modeller. Dette er studiene som er analysert;</p>
<ul>
<li>“5-week block periodization increases aerobic power in elite cross-country skiers” <span class="citation" data-cites="Rønnestad2016">(<a href="#ref-Rønnestad2016" role="doc-biblioref">Rønnestad et al. 2016</a>)</span></li>
<li>“Block periodization of high-intensity aerobic intervals provides superior training effects in trained cyclists” <span class="citation" data-cites="Rønnestad2014">(<a href="#ref-Rønnestad2014" role="doc-biblioref">Rønnestad, Hansen, and Ellefsen 2014</a>)</span></li>
<li>“Block periodization in alpine skiing: effects of 11-day HIT on V̇O<sub>2max</sub> and performance” <span class="citation" data-cites="Breil">(<a href="#ref-Breil" role="doc-biblioref">Breil et al. 2010</a>)</span></li>
<li>“Effect of 12 weeks block periodization on performance and performance indices in well-trained cyclist” <span class="citation" data-cites="Rønnestad12weeks">(<a href="#ref-Rønnestad12weeks" role="doc-biblioref">Rønnestad et al. 2014</a>)</span></li>
<li>“Performance changes in world-class kayakers following two different training periodization models” <span class="citation" data-cites="Garcia">(<a href="#ref-Garcia" role="doc-biblioref">Garcı́a-Pallarés et al. 2010</a>)</span></li>
</ul>
</section>
<section id="resultat" class="level2">
<h2 class="anchored" data-anchor-id="resultat">Resultat</h2>
<p>Alle studiene indikerer at BP gir større økning i V̇O<sub>2max</sub> enn TRAD. Analysen viser til en gjennomgående bruk av RCT, med én overkryssningsstudie <span class="citation" data-cites="Garcia">(<a href="#ref-Garcia" role="doc-biblioref">Garcı́a-Pallarés et al. 2010</a>)</span>, som studiedesign med et utvalg på 10 - 20 forsøkspersoner totalt. Utvalget varierte fra godt trente til utøvere i verdensklasse. Videre ble det gjennomført pre- og post-intervensjonstesting av både fysiologiske variabler og variabler som mål på prestasjon. Studiene varierte med intervensjoner som pågikk fra 11 dager - 2 år.</p>
<p>Studiene benyttet seg av variansanalyser (ANOVA og t-test) for å måle forskjeller over tid mellom grupper. Én studie brukte kovariansanalyse (ANCOVA) og kun èn viste til statistisk styrkeberegning.</p>
</section>
<section id="diskusjon" class="level2">
<h2 class="anchored" data-anchor-id="diskusjon">Diskusjon</h2>
<section id="studiedesign-og-valg-av-metode" class="level3">
<h3 class="anchored" data-anchor-id="studiedesign-og-valg-av-metode">Studiedesign og valg av metode</h3>
<p>I idrettsvitenskap anses et RCT-design som gullstandarden. Ved å bruke RCT-design, som de analyserte studiene gjør, skapes et godt grunnlag for å kontrollere for eksterne faktorer. Dette igjen øker sannsynligheten for at resultatene kan forklares på bakgrunn av intervensjonen. En av de inkluderte studiene benytter en overkryssningsstudie. Dette muliggjør sammenligning av to ulike treningsformer innad i samme gruppe, men kan være utfordrende med tanke på “carryover”-effekter – det vil si at effektene fra den første perioden påvirker resultatene i den andre perioden <span class="citation" data-cites="Senn">(<a href="#ref-Senn" role="doc-biblioref">Senn 2002</a>)</span>.</p>
<p>Hva gjelder utvalg er det fordeler og ulemper ved bruk av eliteutøvere og utøvere i verdensklasse. På den ene siden gir eliteutøvere et høyt prestasjonsnivå noe som gjør det enklere å observere mindre, men meningsfulle forandringer i målte variabler <span class="citation" data-cites="Hopkins">(<a href="#ref-Hopkins" role="doc-biblioref">Hopkins 2000</a>)</span>. På en annen side er utvalgsstørrelsen liten, noe som kan begrense studiens evne til å generalisere samt påvirke den statistisk styrken <span class="citation" data-cites="Spiegelhalter">(<a href="#ref-Spiegelhalter" role="doc-biblioref">Spiegelhalter 2019</a>)</span>.</p>
</section>
<section id="statistiske-modeller" class="level3">
<h3 class="anchored" data-anchor-id="statistiske-modeller">Statistiske modeller</h3>
<p>I statistisk analyse av data benyttes variansanalyse (ANOVA og t-test) i de fleste studiene. Disse analysemetodene er gode for å undersøke forskjeller over tid mellom grupper. Dette er også passende modeller for gjentatte målinger hvor forskerne ønsker å sammenligne en gruppe med seg selv og med en kontrollgruppe. En av studiene benytter ANCOVA. Denne kovariansanalysen justerer for variasjoner i pre-intervensjonsverdier (regression to the mean) og kan potensielt sett gi et bedre bilde av BP sin effekt. At kun én studie rapporterer statistisk styrke er en betydelig svakhet da dette begrenser forståelsen av eksperimentets pålitelighet <span class="citation" data-cites="Spiegelhalter">(<a href="#ref-Spiegelhalter" role="doc-biblioref">Spiegelhalter 2019</a>)</span>.</p>
<p>Statistisk styrke er særlig relevant da små utvalg øker risikoen for type II-feil (falske negative). Altså at man ikke finner en effekt der en effekt faktisk eksisterer<span class="citation" data-cites="Spiegelhalter">(<a href="#ref-Spiegelhalter" role="doc-biblioref">Spiegelhalter 2019</a>)</span>. Den lave bruken av beregning av statistisk styrke gjør det utfordrende å konkludere med at BP faktisk er signifikant bedre enn TRAD. En anbefaling, slik jeg har forstått det, vil være å inkludere beregning av statistisk styrke som en del av metoden i idrettsvitenskapelige studier.</p>
</section>
<section id="varighet-og-oppfølging" class="level3">
<h3 class="anchored" data-anchor-id="varighet-og-oppfølging">Varighet og oppfølging</h3>
<p>Treningsintervensjonene i studiene varierer alt fra 11 dager til 2 år. Dette gir et variert bilde av BP sin effekt på kort og lang sikt. Variasjonen i intervensjonslengde gjør det mulig å sammenligne kortsiktige og langsiktige responser, men det kan også føre til utfordringer i hvordan vi tolker resultatene. Studier med lengre varighet kan for eksempel vise effekter som utvikles over tid, men det kan da være vanskeligere å kontrollere for de potensielt eksterne faktorene som påvirker utviklingen utover intervensjonen <span class="citation" data-cites="Bacon">(<a href="#ref-Bacon" role="doc-biblioref">Bacon et al. 2013</a>)</span>.</p>
</section>
<section id="konklusjon" class="level3">
<h3 class="anchored" data-anchor-id="konklusjon">Konklusjon</h3>
<p>Samlet sett peker analysen mot at BP har større effekt på V̇O<sub>2max</sub> enn TRAD i de aktuelle studiene, men svakheter som små utvalg og mangel på statistisk styrke begrenser grunnlaget for å kunne gi noen generelle anbefalinger. For fremtidig forskning anbefales det å fokusere på metodologiske forbedringer, som å øke størrelsen på utvalget, gjøre flere longitudinelle studier med bedre standradisering og oppfølging. Hva gjelder statistikk vil implementering av styrkeberegning og standardiserte analyser øke studienes kredibilitet. Disse anbefalingene vil trolig gi et mer virklighetsnært bilde av BP sin effekt på V̇O<sub>2max</sub>.</p>

</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Atkinson" class="csl-entry" role="listitem">
Atkinson, G, and A M Nevill. 2001. <span>“Selected Issues in the Design and Analysis of Sport Performance Research.”</span> <em>J. Sports Sci.</em> 19 (10): 811–27.
</div>
<div id="ref-Bacon" class="csl-entry" role="listitem">
Bacon, Andrew P, Rickey E Carter, Eric A Ogle, and Michael J Joyner. 2013. <span>“<span>VO2max</span> Trainability and High Intensity Interval Training in Humans: A Meta-Analysis.”</span> <em>PLoS One</em> 8 (9): e73182.
</div>
<div id="ref-Bouchard" class="csl-entry" role="listitem">
Bouchard, Claude, Steven N Blair, and William L Haskell. 2012. <span>“Physical Activity and Health.”</span> Edited by Claude Bouchard, Steven N Blair, and William L Haskell, February.
</div>
<div id="ref-Breil" class="csl-entry" role="listitem">
Breil, Fabio A, Simone N Weber, Stefan Koller, Hans Hoppeler, and Michael Vogt. 2010. <span>“Block Training Periodization in Alpine Skiing: Effects of 11-Day <span>HIT</span> on <span>VO2max</span> and Performance.”</span> <em>Eur. J. Appl. Physiol.</em> 109 (6): 1077–86.
</div>
<div id="ref-Brosowsky" class="csl-entry" role="listitem">
Brosowsky, Nicholaus, Olga Parshina, Anthony Locicero, and Matthew John Charles Crump. 2020. <span>“Teaching Undergraduate Students to Read Empirical Articles: An Evaluation and Revision of the <span>QALMRI</span> Method.”</span> <em>PsyArXiv</em>, June.
</div>
<div id="ref-Creswell" class="csl-entry" role="listitem">
Creswell, John W. 2008. <span>“Research Design,”</span> July.
</div>
<div id="ref-Garcia" class="csl-entry" role="listitem">
Garcı́a-Pallarés, Jesús, Miguel Garcı́a-Fernández, Luis Sánchez-Medina, and Mikel Izquierdo. 2010. <span>“Performance Changes in World-Class Kayakers Following Two Different Training Periodization Models.”</span> <em>Eur. J. Appl. Physiol.</em> 110 (1): 99–107.
</div>
<div id="ref-Hopkins" class="csl-entry" role="listitem">
Hopkins, W G. 2000. <span>“Measures of Reliability in Sports Medicine and Science.”</span> <em>Sports Med.</em> 30 (1): 1–15.
</div>
<div id="ref-Hulley" class="csl-entry" role="listitem">
Hulley, Stephen B, Steven R Cummings, Warren S Browner, Deborah G Grady, and Thomas B Newman. 2006. <em>Designing Clinical Research</em>. 3rd ed. Philadelphia, PA: Lippincott Williams; Wilkins.
</div>
<div id="ref-Knight" class="csl-entry" role="listitem">
Knight, Kenneth L. 2010. <span>“Study/Experimental/Research Design: Much More Than Statistics.”</span> <em>J. Athl. Train.</em> 45 (1): 98–100.
</div>
<div id="ref-Rønnestad12weeks" class="csl-entry" role="listitem">
Rønnestad, B R, S Ellefsen, H Nygaard, E E Zacharoff, O Vikmoen, J Hansen, and J Hallén. 2014. <span>“Effects of 12 Weeks of Block Periodization on Performance and Performance Indices in Well-Trained Cyclists.”</span> <em>Scand. J. Med. Sci. Sports</em> 24 (2): 327–35.
</div>
<div id="ref-Rønnestad2014" class="csl-entry" role="listitem">
Rønnestad, B R, J Hansen, and S Ellefsen. 2014. <span>“Block Periodization of High-Intensity Aerobic Intervals Provides Superior Training Effects in Trained Cyclists.”</span> <em>Scand. J. Med. Sci. Sports</em> 24 (1): 34–42.
</div>
<div id="ref-Rønnestad2016" class="csl-entry" role="listitem">
Rønnestad, B R, J Hansen, V Thyli, T A Bakken, and Ø Sandbakk. 2016. <span>“5-Week Block Periodization Increases Aerobic Power in Elite Cross-Country Skiers.”</span> <em>Scand. J. Med. Sci. Sports</em> 26 (2): 140–46.
</div>
<div id="ref-Senn" class="csl-entry" role="listitem">
Senn, Stephen S. 2002. <span>“Cross-over Trials in Clinical Research,”</span> Statistics in practice, July.
</div>
<div id="ref-Spiegelhalter" class="csl-entry" role="listitem">
Spiegelhalter, David. 2019. <span>“The Art of Statistics,”</span> September.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>